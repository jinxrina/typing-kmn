<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TypeMaster Pro - Ultimate Typing Experience</title>
    <style>
        :root {
            /* Dark Theme (Default) */
            --bg-primary: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 25%, #16213e 50%, #0f3460 75%, #533483 100%);
            --bg-secondary: linear-gradient(145deg, rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.2));
            --bg-container: linear-gradient(145deg, rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.1));
            --bg-input: linear-gradient(145deg, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.3));
            --text-primary: rgba(255, 255, 255, 0.9);
            --text-secondary: rgba(255, 255, 255, 0.8);
            --accent-gold: #ffd700;
            --accent-gold-light: #ffed4e;
            --border-color: rgba(255, 215, 0, 0.2);
            --correct-color: #00ff7f;
            --error-color: #ff1493;
            --shadow-color: rgba(0, 0, 0, 0.3);
        }

        .light-theme {
            /* Light Theme */
            --bg-primary: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 25%, #dee2e6 50%, #ced4da 75%, #adb5bd 100%);
            --bg-secondary: linear-gradient(145deg, rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.7));
            --bg-container: linear-gradient(145deg, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.8));
            --bg-input: linear-gradient(145deg, rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.7));
            --text-primary: rgba(33, 37, 41, 0.9);
            --text-secondary: rgba(33, 37, 41, 0.7);
            --accent-gold: #ff6b35;
            --accent-gold-light: #ff8c42;
            --border-color: rgba(255, 107, 53, 0.3);
            --correct-color: #28a745;
            --error-color: #dc3545;
            --shadow-color: rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            transition: all 0.5s ease;
            color: var(--text-primary);
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 20% 80%, rgba(255, 215, 0, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 80% 20%, rgba(255, 105, 180, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 40% 40%, rgba(138, 43, 226, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: 1;
            transition: opacity 0.5s ease;
        }

        .light-theme body::before {
            background: radial-gradient(circle at 20% 80%, rgba(255, 107, 53, 0.05) 0%, transparent 50%),
                        radial-gradient(circle at 80% 20%, rgba(74, 144, 226, 0.05) 0%, transparent 50%),
                        radial-gradient(circle at 40% 40%, rgba(138, 43, 226, 0.05) 0%, transparent 50%);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 10;
        }

        .top-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .theme-toggle, .sound-toggle {
            background: var(--bg-container);
            border: 1px solid var(--border-color);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--accent-gold);
            font-size: 1.5rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .theme-toggle:hover, .sound-toggle:hover {
            background: var(--bg-secondary);
            transform: scale(1.1);
            box-shadow: 0 5px 15px var(--shadow-color);
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            animation: fadeInDown 1s ease-out;
        }

        .title {
            font-size: 3.8rem;
            font-weight: 900;
            color: transparent;
            text-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
            margin-bottom: 10px;
            background: linear-gradient(45deg, var(--accent-gold), var(--accent-gold-light), var(--accent-gold), var(--accent-gold-light));
            background-size: 400% 400%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: premiumGlow 3s ease infinite;
            letter-spacing: 3px;
            text-transform: uppercase;
        }

        .subtitle {
            font-size: 1.3rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
            font-weight: 300;
            letter-spacing: 1px;
        }

        .mode-selector {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .mode-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--bg-container);
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
            border: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
        }

        .mode-btn:hover {
            transform: scale(1.05);
            background: var(--bg-secondary);
        }

        .mode-btn.active {
            background: linear-gradient(45deg, var(--accent-gold), var(--accent-gold-light));
            color: var(--text-primary);
            transform: scale(1.08);
            box-shadow: 0 5px 15px var(--shadow-color);
        }

        .stats-container {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .stat-box {
            background: var(--bg-container);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            color: var(--text-primary);
            min-width: 140px;
            border: 1px solid var(--border-color);
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 215, 0, 0.1), transparent);
            transition: left 0.6s;
        }

        .stat-box:hover::before {
            left: 100%;
        }

        .stat-box:hover {
            transform: translateY(-8px) scale(1.05);
            background: var(--bg-secondary);
            border-color: var(--accent-gold);
            box-shadow: 0 15px 35px var(--shadow-color);
        }

        .stat-number {
            font-size: 2.2rem;
            font-weight: bold;
            margin-bottom: 8px;
            background: linear-gradient(45deg, var(--accent-gold), var(--text-primary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stat-label {
            font-size: 0.95rem;
            opacity: 0.9;
            font-weight: 300;
            letter-spacing: 0.5px;
            color: var(--text-secondary);
        }

        .game-container {
            background: var(--bg-secondary);
            backdrop-filter: blur(30px);
            border-radius: 25px;
            padding: 45px;
            box-shadow: 0 25px 50px var(--shadow-color);
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
            border: 1px solid var(--border-color);
        }

        .settings-row {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .difficulty-selector, .time-selector {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .selector-label {
            font-weight: 600;
            color: var(--text-secondary);
            margin-right: 10px;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .difficulty-btn, .time-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--bg-container);
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
            border: 1px solid var(--border-color);
        }

        .difficulty-btn:hover, .time-btn:hover {
            transform: scale(1.05);
            background: var(--bg-secondary);
        }

        .difficulty-btn.active, .time-btn.active {
            background: linear-gradient(45deg, var(--accent-gold), var(--accent-gold-light));
            color: var(--text-primary);
            transform: scale(1.08);
        }

        .text-display {
            font-size: 1.5rem;
            line-height: 2.2;
            padding: 35px;
            background: var(--bg-input);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            margin-bottom: 25px;
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
            color: var(--text-primary);
            font-family: 'Courier New', monospace;
        }

        .text-display::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-gold), var(--accent-gold-light), var(--accent-gold));
            background-size: 200% 100%;
            animation: goldFlow 2s linear infinite;
        }

        .char {
            position: relative;
            transition: all 0.3s ease;
            border-radius: 3px;
            padding: 2px 1px;
        }

        .char.correct {
            background: linear-gradient(45deg, rgba(0, 255, 127, 0.3), rgba(50, 205, 50, 0.3));
            color: var(--correct-color);
            text-shadow: 0 0 10px rgba(0, 255, 127, 0.5);
            animation: correctPulse 0.3s ease;
        }

        .light-theme .char.correct {
            background: linear-gradient(45deg, rgba(40, 167, 69, 0.2), rgba(40, 167, 69, 0.1));
            color: var(--correct-color);
            text-shadow: none;
        }

        .char.incorrect {
            background: linear-gradient(45deg, rgba(255, 20, 147, 0.4), rgba(220, 20, 60, 0.4));
            color: var(--error-color);
            text-shadow: 0 0 10px rgba(255, 20, 147, 0.5);
            animation: errorShake 0.4s ease-in-out;
        }

        .light-theme .char.incorrect {
            background: linear-gradient(45deg, rgba(220, 53, 69, 0.2), rgba(220, 53, 69, 0.1));
            color: var(--error-color);
            text-shadow: none;
        }

        .char.current {
            background: linear-gradient(45deg, var(--accent-gold), var(--accent-gold-light));
            color: var(--text-primary);
            text-shadow: none;
            animation: currentBlink 1.2s infinite;
            transform: scale(1.1);
        }

        .input-area {
            width: 100%;
            font-size: 1.5rem;
            padding: 25px;
            border: 2px solid var(--border-color);
            border-radius: 20px;
            outline: none;
            transition: all 0.4s ease;
            background: var(--bg-input);
            backdrop-filter: blur(10px);
            color: var(--text-primary);
            font-family: 'Courier New', monospace;
        }

        .input-area::placeholder {
            color: var(--text-secondary);
        }

        .input-area:focus {
            border-color: var(--accent-gold);
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.4);
            background: var(--bg-secondary);
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: var(--bg-container);
            border-radius: 8px;
            margin: 25px 0;
            overflow: hidden;
            border: 1px solid var(--border-color);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-gold), var(--accent-gold-light), var(--accent-gold));
            width: 0%;
            transition: width 0.4s ease;
            position: relative;
            border-radius: 8px;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: shimmer 2s infinite;
        }

        .control-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 25px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 15px 35px;
            border: none;
            border-radius: 30px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.4s ease;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            position: relative;
            overflow: hidden;
        }

        .btn-primary {
            background: linear-gradient(45deg, var(--accent-gold), var(--accent-gold-light));
            color: var(--text-primary);
            border: 1px solid var(--accent-gold);
        }

        .btn-secondary {
            background: var(--bg-container);
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
        }

        .btn:hover {
            transform: translateY(-4px) scale(1.05);
            box-shadow: 0 15px 30px var(--shadow-color);
        }

        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 2;
        }

        .particle {
            position: absolute;
            border-radius: 50%;
            animation: float 8s linear infinite;
        }

        .particle.gold {
            background: radial-gradient(circle, var(--accent-gold), var(--accent-gold-light));
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }

        .particle.silver {
            background: radial-gradient(circle, #c0c0c0, #e6e6fa);
            box-shadow: 0 0 10px rgba(192, 192, 192, 0.5);
        }

        .particle.purple {
            background: radial-gradient(circle, #8a2be2, #9370db);
            box-shadow: 0 0 10px rgba(138, 43, 226, 0.5);
        }

        .result-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(20px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background: var(--bg-secondary);
            backdrop-filter: blur(30px);
            padding: 50px;
            border-radius: 25px;
            text-align: center;
            max-width: 600px;
            width: 90%;
            transform: scale(0);
            transition: transform 0.4s ease;
            border: 1px solid var(--border-color);
            color: var(--text-primary);
        }

        .modal-content.show {
            transform: scale(1);
        }

        .modal-title {
            font-size: 3rem;
            background: linear-gradient(45deg, var(--accent-gold), var(--accent-gold-light));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 25px;
            font-weight: 900;
        }

        .modal-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 25px;
            margin: 35px 0;
        }

        .modal-stat {
            padding: 20px;
            background: var(--bg-container);
            border-radius: 15px;
            border: 1px solid var(--border-color);
        }

        .modal-stat-number {
            font-size: 2rem;
            font-weight: bold;
            background: linear-gradient(45deg, var(--accent-gold), var(--text-primary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .modal-stat-label {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-top: 8px;
            font-weight: 300;
        }

        .custom-text-area {
            width: 100%;
            min-height: 120px;
            font-size: 1.2rem;
            padding: 20px;
            border: 2px solid var(--border-color);
            border-radius: 15px;
            outline: none;
            background: var(--bg-input);
            color: var(--text-primary);
            margin-bottom: 20px;
            font-family: 'Courier New', monospace;
            resize: vertical;
        }

        .leaderboard {
            background: var(--bg-container);
            border-radius: 20px;
            padding: 30px;
            margin-top: 30px;
            border: 1px solid var(--border-color);
        }

        .leaderboard-title {
            font-size: 1.8rem;
            text-align: center;
            margin-bottom: 20px;
            color: var(--accent-gold);
            font-weight: bold;
        }

        .leaderboard-entry {
            display: flex;
            justify-content: space-between;
            padding: 10px 15px;
            margin-bottom: 10px;
            background: var(--bg-input);
            border-radius: 10px;
            border: 1px solid var(--border-color);
        }

        .leaderboard-rank {
            font-weight: bold;
            color: var(--accent-gold);
        }

        @keyframes premiumGlow {
            0%, 100% { 
                background-position: 0% 50%;
                text-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
            }
            50% { 
                background-position: 100% 50%;
                text-shadow: 0 0 40px rgba(255, 215, 0, 0.8);
            }
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes currentBlink {
            0%, 50% { opacity: 1; transform: scale(1.1); }
            51%, 100% { opacity: 0.6; transform: scale(1.05); }
        }

        @keyframes correctPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.15); }
            100% { transform: scale(1); }
        }

        @keyframes errorShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        @keyframes goldFlow {
            0% { background-position: 0% 0%; }
            100% { background-position: 200% 0%; }
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(200%); }
        }

        @keyframes float {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) rotate(360deg);
                opacity: 0;
            }
        }

        @media (max-width: 768px) {
            .title {
                font-size: 2.8rem;
            }
            
            .stats-container {
                gap: 15px;
            }
            
            .stat-box {
                min-width: 120px;
                padding: 20px;
            }
            
            .game-container {
                padding: 25px;
            }
            
            .text-display {
                font-size: 1.3rem;
                padding: 25px;
            }
            
            .input-area {
                font-size: 1.3rem;
                padding: 20px;
            }

            .mode-selector, .settings-row {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="top-controls">
        <div class="theme-toggle" id="themeToggle" title="Toggle Theme">🌓</div>
        <div class="sound-toggle" id="soundToggle" title="Toggle Sound">🔊</div>
    </div>

    <div class="particles" id="particles"></div>
    
    <div class="container">
        <header class="header">
            <h1 class="title">TypeMaster Pro</h1>
            <p class="subtitle">Ultimate typing mastery with premium features and immersive experience <br> Created By Kyaw Myo Naing <br> Ph - 095401593</p>
        </header>

        <div class="mode-selector">
            <button class="mode-btn active" data-mode="time">⏱️ Time Challenge</button>
            <button class="mode-btn" data-mode="words">📝 Word Count</button>
            <button class="mode-btn" data-mode="quotes">💭 Inspirational Quotes</button>
            <button class="mode-btn" data-mode="code">💻 Code Practice</button>
            <button class="mode-btn" data-mode="numbers">🔢 Numbers & Symbols</button>
            <button class="mode-btn" data-mode="custom">✏️ Custom Text</button>
        </div>

        <div class="stats-container">
            <div class="stat-box">
                <div class="stat-number" id="wpm">0</div>
                <div class="stat-label">WPM</div>
            </div>
            <div class="stat-box">
                <div class="stat-number" id="accuracy">100</div>
                <div class="stat-label">Accuracy %</div>
            </div>
            <div class="stat-box">
                <div class="stat-number" id="target" data-target="60">60</div>
                <div class="stat-label" id="targetLabel">Time Left</div>
            </div>
            <div class="stat-box">
                <div class="stat-number" id="errors">0</div>
                <div class="stat-label">Errors</div>
            </div>
        </div>

        <div class="game-container">
            <div class="settings-row">
                <div class="difficulty-selector">
                    <span class="selector-label">Level:</span>
                    <button class="difficulty-btn active" data-difficulty="easy">Novice</button>
                    <button class="difficulty-btn" data-difficulty="medium">Expert</button>
                    <button class="difficulty-btn" data-difficulty="hard">Master</button>
                </div>
                <div class="time-selector" id="timeSelector">
                    <span class="selector-label">Duration:</span>
                    <button class="time-btn" data-time="30">30s</button>
                    <button class="time-btn active" data-time="60">60s</button>
                    <button class="time-btn" data-time="120">2min</button>
                    <button class="time-btn" data-time="300">5min</button>
                </div>
            </div>

            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>

            <div class="text-display" id="textDisplay"></div>

            <textarea class="custom-text-area" id="customTextArea" placeholder="Enter your custom text here..." style="display: none;"></textarea>

            <textarea class="input-area" id="inputArea" placeholder="Click here and begin your premium typing experience..."></textarea>

            <div class="control-buttons">
                <button class="btn btn-primary" id="startBtn">Start Experience</button>
                <button class="btn btn-secondary" id="resetBtn">Reset</button>
                <button class="btn btn-secondary" id="newTextBtn">New Text</button>
            </div>
        </div>

        <div class="leaderboard" id="leaderboard">
            <h3 class="leaderboard-title">🏆 Personal Best Scores</h3>
            <div id="leaderboardEntries">
                <div class="leaderboard-entry">
                    <span class="leaderboard-rank">#1</span>
                    <span>85 WPM - 96% Accuracy</span>
                    <span>Expert Mode</span>
                </div>
            </div>
        </div>
    </div>

    <div class="result-modal" id="resultModal">
        <div class="modal-content" id="modalContent">
            <h2 class="modal-title">🏆 Excellence Achieved!</h2>
            <div class="modal-stats" id="modalStats"></div>
            <button class="btn btn-primary" onclick="closeModal()">Continue Excellence</button>
        </div>
    </div>

    <script>
        class AudioManager {
            constructor() {
                this.audioContext = null;
                this.soundEnabled = true;
                this.initAudio();
            }

            initAudio() {
                try {
                    this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                } catch (e) {
                    console.log('Audio not supported');
                }
            }

            playSound(frequency, duration, type = 'sine', volume = 0.3) {
                if (!this.soundEnabled || !this.audioContext) return;

                const oscillator = this.audioContext.createOscillator();
                const gainNode = this.audioContext.createGain();

                oscillator.connect(gainNode);
                gainNode.connect(this.audioContext.destination);

                oscillator.frequency.setValueAtTime(frequency, this.audioContext.currentTime);
                oscillator.type = type;

                gainNode.gain.setValueAtTime(0, this.audioContext.currentTime);
                gainNode.gain.linearRampToValueAtTime(volume, this.audioContext.currentTime + 0.01);
                gainNode.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + duration);

                oscillator.start(this.audioContext.currentTime);
                oscillator.stop(this.audioContext.currentTime + duration);
            }

            playCorrectSound() {
                this.playSound(800, 0.1, 'sine', 0.2);
            }

            playErrorSound() {
                this.playSound(200, 0.2, 'sawtooth', 0.3);
            }

            playStartSound() {
                this.playSound(440, 0.3, 'triangle', 0.4);
                setTimeout(() => this.playSound(880, 0.3, 'triangle', 0.4), 150);
            }

            playCompleteSound() {
                this.playSound(523, 0.8, 'sine', 0.3);
                setTimeout(() => this.playSound(659, 0.8, 'sine', 0.3), 100);
                setTimeout(() => this.playSound(784, 0.8, 'sine', 0.3), 200);
                setTimeout(() => this.playSound(1047, 1.2, 'sine', 0.4), 300);
            }

            playKeySound() {
                this.playSound(1200 + Math.random() * 200, 0.05, 'square', 0.1);
            }

            playHoverSound() {
                this.playSound(600, 0.1, 'sine', 0.15);
            }

            toggleSound() {
                this.soundEnabled = !this.soundEnabled;
                return this.soundEnabled;
            }
        }

        class TypingGame {
            constructor() {
                this.audioManager = new AudioManager();
                this.currentMode = 'time';
                this.currentTime = 60;
                
                this.texts = {
                    easy: [
                        "The quick brown fox jumps over the lazy dog. This sentence contains every letter of the alphabet and helps improve typing fluency.",
                        "Coding is both fun and rewarding. Practice makes perfect in programming and typing skills development for modern professionals.",
                        "Technology evolves rapidly in our digital world. We must adapt and learn new skills constantly to stay competitive and relevant."
                    ],
                    medium: [
                        "JavaScript frameworks like React, Vue, and Angular revolutionize modern web development by providing powerful tools for building interactive user interfaces.",
                        "Artificial intelligence and machine learning algorithms are transforming industries across the globe with unprecedented speed and efficiency in automation.",
                        "Climate change requires immediate collaborative action from governments, businesses, and individuals to protect our planet's fragile ecosystems."
                    ],
                    hard: [
                        "Quantum computing represents a paradigmatic shift that could revolutionize cryptography, optimization, and complex problem-solving methodologies across multiple scientific disciplines.",
                        "Biodiversity conservation efforts must carefully balance economic development initiatives with ecological preservation strategies to ensure sustainable environmental futures.",
                        "Neuroplasticity demonstrates the brain's remarkable capacity to reorganize, adapt, and form new neural pathways throughout an individual's entire lifetime."
                    ]
                };

                this.quotes = [
                    "The only way to do great work is to love what you do. - Steve Jobs",
                    "Innovation distinguishes between a leader and a follower. - Steve Jobs",
                    "Life is what happens to you while you're busy making other plans. - John Lennon",
                    "The future belongs to those who believe in the beauty of their dreams. - Eleanor Roosevelt",
                    "It is during our darkest moments that we must focus to see the light. - Aristotle"
                ];

                this.codeSnippets = [
                    "function calculateSum(a, b) {\n    return a + b;\n}\n\nconst result = calculateSum(10, 20);",
                    "class Rectangle {\n    constructor(width, height) {\n        this.width = width;\n        this.height = height;\n    }\n}",
                    "const numbers = [1, 2, 3, 4, 5];\nconst doubled = numbers.map(n => n * 2);\nconsole.log(doubled);"
                ];

                this.numbersText = [
                    "1234567890 !@#$%^&*() []{}|\\:;\"'<>,.?/",
                    "Price: $299.99, Discount: 15%, Tax: 8.25%, Total: $276.74",
                    "IP Address: 192.168.1.1, Port: 8080, Version: 2.1.4"
                ];
                
                this.currentText = '';
                this.currentIndex = 0;
                this.startTime = 0;
                this.endTime = 0;
                this.isGameActive = false;
                this.timeLeft = 60;
                this.timer = null;
                this.errors = 0;
                this.difficulty = 'easy';
                this.lastChar = '';
                this.wordsTarget = 50;
                this.wordsTyped = 0;
                
                this.initializeElements();
                this.setupEventListeners();
                this.createParticles();
                this.loadNewText();
                this.loadLeaderboard();
            }

            initializeElements() {
                this.textDisplay = document.getElementById('textDisplay');
                this.inputArea = document.getElementById('inputArea');
                this.customTextArea = document.getElementById('customTextArea');
                this.startBtn = document.getElementById('startBtn');
                this.resetBtn = document.getElementById('resetBtn');
                this.newTextBtn = document.getElementById('newTextBtn');
                this.wpmElement = document.getElementById('wpm');
                this.accuracyElement = document.getElementById('accuracy');
                this.targetElement = document.getElementById('target');
                this.targetLabel = document.getElementById('targetLabel');
                this.errorsElement = document.getElementById('errors');
                this.progressFill = document.getElementById('progressFill');
                this.resultModal = document.getElementById('resultModal');
                this.modalContent = document.getElementById('modalContent');
                this.soundToggle = document.getElementById('soundToggle');
                this.themeToggle = document.getElementById('themeToggle');
                this.timeSelector = document.getElementById('timeSelector');
            }

            setupEventListeners() {
                this.startBtn.addEventListener('click', () => {
                    this.audioManager.playStartSound();
                    this.startGame();
                });
                
                this.resetBtn.addEventListener('click', () => {
                    this.audioManager.playHoverSound();
                    this.resetGame();
                });

                this.newTextBtn.addEventListener('click', () => {
                    this.audioManager.playHoverSound();
                    this.loadNewText();
                    this.resetGame();
                });
                
                this.inputArea.addEventListener('input', (e) => this.handleInput(e));
                this.inputArea.addEventListener('focus', () => this.startGame());
                
                // Custom text area
                this.customTextArea.addEventListener('input', () => {
                    this.currentText = this.customTextArea.value;
                    this.displayText();
                });
                
                // Sound toggle
                this.soundToggle.addEventListener('click', () => {
                    const enabled = this.audioManager.toggleSound();
                    this.soundToggle.textContent = enabled ? '🔊' : '🔇';
                    this.soundToggle.title = enabled ? 'Mute Sound' : 'Enable Sound';
                    this.audioManager.playHoverSound();
                });

                // Theme toggle
                this.themeToggle.addEventListener('click', () => {
                    document.body.classList.toggle('light-theme');
                    const isLight = document.body.classList.contains('light-theme');
                    this.themeToggle.textContent = isLight ? '☀️' : '🌓';
                    this.themeToggle.title = isLight ? 'Switch to Dark Theme' : 'Switch to Light Theme';
                    this.audioManager.playHoverSound();
                    
                    // Save theme preference
                    localStorage.setItem('theme', isLight ? 'light' : 'dark');
                });
                
                // Mode selector
                document.querySelectorAll('.mode-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        this.audioManager.playHoverSound();
                        document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
                        e.target.classList.add('active');
                        this.currentMode = e.target.dataset.mode;
                        this.switchMode();
                        this.resetGame();
                    });
                });
                
                // Difficulty selector
                document.querySelectorAll('.difficulty-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        this.audioManager.playHoverSound();
                        document.querySelectorAll('.difficulty-btn').forEach(b => b.classList.remove('active'));
                        e.target.classList.add('active');
                        this.difficulty = e.target.dataset.difficulty;
                        this.loadNewText();
                        this.resetGame();
                    });
                });

                // Time selector
                document.querySelectorAll('.time-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        this.audioManager.playHoverSound();
                        document.querySelectorAll('.time-btn').forEach(b => b.classList.remove('active'));
                        e.target.classList.add('active');
                        this.currentTime = parseInt(e.target.dataset.time);
                        this.resetGame();
                    });
                });

                // Button hover sounds
                document.querySelectorAll('.btn, .stat-box, .mode-btn, .difficulty-btn, .time-btn').forEach(element => {
                    element.addEventListener('mouseenter', () => {
                        this.audioManager.playHoverSound();
                    });
                });

                // Load saved theme
                const savedTheme = localStorage.getItem('theme');
                if (savedTheme === 'light') {
                    document.body.classList.add('light-theme');
                    this.themeToggle.textContent = '☀️';
                    this.themeToggle.title = 'Switch to Dark Theme';
                }
            }

            switchMode() {
                this.customTextArea.style.display = this.currentMode === 'custom' ? 'block' : 'none';
                
                if (this.currentMode === 'words') {
                    this.timeSelector.style.display = 'none';
                    this.targetLabel.textContent = 'Words Left';
                    this.targetElement.textContent = this.wordsTarget;
                    this.targetElement.dataset.target = this.wordsTarget;
                } else {
                    this.timeSelector.style.display = 'flex';
                    this.targetLabel.textContent = 'Time Left';
                    this.targetElement.textContent = this.currentTime;
                    this.targetElement.dataset.target = this.currentTime;
                }
                
                this.loadNewText();
            }

            createParticles() {
                const particlesContainer = document.getElementById('particles');
                const particleTypes = ['gold', 'silver', 'purple'];
                
                setInterval(() => {
                    if (this.isGameActive) {
                        const particle = document.createElement('div');
                        const type = particleTypes[Math.floor(Math.random() * particleTypes.length)];
                        particle.className = `particle ${type}`;
                        particle.style.left = Math.random() * 100 + '%';
                        particle.style.width = particle.style.height = (Math.random() * 6 + 4) + 'px';
                        particle.style.animationDuration = (Math.random() * 4 + 4) + 's';
                        particlesContainer.appendChild(particle);
                        
                        setTimeout(() => {
                            particle.remove();
                        }, 8000);
                    }
                }, 200);
            }

            loadNewText() {
                switch (this.currentMode) {
                    case 'time':
                        const textArray = this.texts[this.difficulty];
                        this.currentText = textArray[Math.floor(Math.random() * textArray.length)];
                        break;
                    case 'words':
                        const wordsArray = this.texts[this.difficulty];
                        this.currentText = wordsArray[Math.floor(Math.random() * wordsArray.length)];
                        break;
                    case 'quotes':
                        this.currentText = this.quotes[Math.floor(Math.random() * this.quotes.length)];
                        break;
                    case 'code':
                        this.currentText = this.codeSnippets[Math.floor(Math.random() * this.codeSnippets.length)];
                        break;
                    case 'numbers':
                        this.currentText = this.numbersText[Math.floor(Math.random() * this.numbersText.length)];
                        break;
                    case 'custom':
                        this.currentText = this.customTextArea.value || "Type your custom text in the text area above.";
                        break;
                }
                
                this.displayText();
                this.currentIndex = 0;
            }

            displayText() {
                this.textDisplay.innerHTML = this.currentText
                    .split('')
                    .map((char, index) => `<span class="char" data-index="${index}">${char}</span>`)
                    .join('');
            }

            startGame() {
                if (!this.isGameActive) {
                    this.isGameActive = true;
                    this.startTime = Date.now();
                    this.inputArea.disabled = false;
                    this.inputArea.focus();
                    this.startBtn.textContent = 'Experience Active...';
                    this.startBtn.disabled = true;
                    
                    if (this.currentMode === 'words') {
                        this.wordsTyped = 0;
                    } else {
                        this.timeLeft = this.currentTime;
                        this.startTimer();
                    }
                }
            }

            startTimer() {
                this.timer = setInterval(() => {
                    this.timeLeft--;
                    this.targetElement.textContent = this.timeLeft;
                    
                    if (this.timeLeft <= 10 && this.timeLeft > 0) {
                        this.audioManager.playSound(400 + this.timeLeft * 50, 0.1, 'triangle', 0.2);
                    }
                    
                    if (this.timeLeft <= 0) {
                        this.endGame();
                    }
                }, 1000);
            }

            handleInput(e) {
                if (!this.isGameActive) return;

                const inputText = e.target.value;
                const chars = document.querySelectorAll('.char');
                
                // Play key sound for new characters
                if (inputText.length > this.lastChar.length) {
                    this.audioManager.playKeySound();
                }
                this.lastChar = inputText;
                
                // Clear previous highlighting
                chars.forEach(char => {
                    char.classList.remove('correct', 'incorrect', 'current');
                });

                let newErrors = 0;
                let correctChars = 0;
                
                // Highlight characters based on input
                for (let i = 0; i < inputText.length; i++) {
                    if (i < this.currentText.length) {
                        const char = chars[i];
                        if (inputText[i] === this.currentText[i]) {
                            char.classList.add('correct');
                            correctChars++;
                            if (i === inputText.length - 1) {
                                this.audioManager.playCorrectSound();
                            }
                        } else {
                            char.classList.add('incorrect');
                            newErrors++;
                            if (i === inputText.length - 1) {
                                this.audioManager.playErrorSound();
                            }
                        }
                    }
                }

                this.errors = newErrors;

                // Highlight current character
                if (inputText.length < this.currentText.length) {
                    chars[inputText.length].classList.add('current');
                }

                // Update progress
                const progress = (inputText.length / this.currentText.length) * 100;
                this.progressFill.style.width = progress + '%';

                // Handle word count mode
                if (this.currentMode === 'words') {
                    const words = inputText.trim() === '' ? 0 : inputText.trim().split(/\s+/).length;
                    this.wordsTyped = words;
                    const wordsLeft = Math.max(0, this.wordsTarget - words);
                    this.targetElement.textContent = wordsLeft;
                    
                    if (wordsLeft <= 0) {
                        this.endGame();
                    }
                }

                this.updateStats(inputText);

                // Check if text is complete
                if (inputText.length === this.currentText.length) {
                    this.endGame();
                }
            }

            updateStats(inputText) {
                const timeElapsed = (Date.now() - this.startTime) / 1000 / 60;
                const wordsTyped = inputText.length / 5;
                const wpm = Math.round(wordsTyped / timeElapsed) || 0;
                
                const correctChars = inputText.split('').filter((char, index) => 
                    char === this.currentText[index]
                ).length;
                const accuracy = inputText.length > 0 ? Math.round((correctChars / inputText.length) * 100) : 100;

                this.wpmElement.textContent = wpm;
                this.accuracyElement.textContent = accuracy;
                this.errorsElement.textContent = this.errors;
            }

            endGame() {
                this.isGameActive = false;
                this.endTime = Date.now();
                clearInterval(this.timer);
                this.inputArea.disabled = true;
                this.startBtn.textContent = 'Start Experience';
                this.startBtn.disabled = false;
                
                this.audioManager.playCompleteSound();
                this.saveScore();
                this.showResults();
            }

            saveScore() {
                const wpm = parseInt(this.wpmElement.textContent);
                const accuracy = parseInt(this.accuracyElement.textContent);
                const score = {
                    wpm,
                    accuracy,
                    mode: this.currentMode,
                    difficulty: this.difficulty,
                    date: new Date().toLocaleDateString()
                };

                let scores = JSON.parse(localStorage.getItem('typingScores') || '[]');
                scores.push(score);
                scores.sort((a, b) => b.wpm - a.wpm);
                scores = scores.slice(0, 10);
                localStorage.setItem('typingScores', JSON.stringify(scores));
                
                this.updateLeaderboard();
            }

            loadLeaderboard() {
                this.updateLeaderboard();
            }

            updateLeaderboard() {
                const scores = JSON.parse(localStorage.getItem('typingScores') || '[]');
                const entriesContainer = document.getElementById('leaderboardEntries');
                
                if (scores.length === 0) {
                    entriesContainer.innerHTML = '<div class="leaderboard-entry"><span>No scores yet - start typing to build your leaderboard!</span></div>';
                    return;
                }

                entriesContainer.innerHTML = scores.map((score, index) => `
                    <div class="leaderboard-entry">
                        <span class="leaderboard-rank">#${index + 1}</span>
                        <span>${score.wpm} WPM - ${score.accuracy}% Accuracy</span>
                        <span>${score.mode} (${score.difficulty})</span>
                    </div>
                `).join('');
            }

            showResults() {
                const finalWPM = this.wpmElement.textContent;
                const finalAccuracy = this.accuracyElement.textContent;
                const timeTaken = this.currentMode === 'words' ? 
                    Math.round((Date.now() - this.startTime) / 1000) : 
                    this.currentTime - this.timeLeft;
                
                const modalStats = document.getElementById('modalStats');
                modalStats.innerHTML = `
                    <div class="modal-stat">
                        <div class="modal-stat-number">${finalWPM}</div>
                        <div class="modal-stat-label">Words Per Minute</div>
                    </div>
                    <div class="modal-stat">
                        <div class="modal-stat-number">${finalAccuracy}%</div>
                        <div class="modal-stat-label">Accuracy</div>
                    </div>
                    <div class="modal-stat">
                        <div class="modal-stat-number">${timeTaken}s</div>
                        <div class="modal-stat-label">Time Taken</div>
                    </div>
                    <div class="modal-stat">
                        <div class="modal-stat-number">${this.errors}</div>
                        <div class="modal-stat-label">Errors</div>
                    </div>
                `;

                this.resultModal.style.display = 'flex';
                setTimeout(() => {
                    this.modalContent.classList.add('show');
                }, 100);
            }

            resetGame() {
                this.isGameActive = false;
                this.currentIndex = 0;
                this.errors = 0;
                this.timeLeft = this.currentTime;
                this.wordsTyped = 0;
                this.lastChar = '';
                clearInterval(this.timer);
                
                this.inputArea.value = '';
                this.inputArea.disabled = false;
                this.startBtn.textContent = 'Start Experience';
                this.startBtn.disabled = false;
                
                this.wpmElement.textContent = '0';
                this.accuracyElement.textContent = '100';
                this.errorsElement.textContent = '0';
                this.progressFill.style.width = '0%';
                
                if (this.currentMode === 'words') {
                    this.targetElement.textContent = this.wordsTarget;
                } else {
                    this.targetElement.textContent = this.currentTime;
                }
                
                if (this.currentMode !== 'custom') {
                    this.loadNewText();
                }
            }
        }

        function closeModal() {
            const modal = document.getElementById('resultModal');
            const modalContent = document.getElementById('modalContent');
            
            modalContent.classList.remove('show');
            setTimeout(() => {
                modal.style.display = 'none';
            }, 300);
            
            game.resetGame();
        }

        const game = new TypingGame();

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeModal();
            }
            if (e.ctrlKey && e.key === 'r') {
                e.preventDefault();
                game.resetGame();
            }
        });

        document.addEventListener('click', () => {
            if (game.audioManager.audioContext && game.audioManager.audioContext.state === 'suspended') {
                game.audioManager.audioContext.resume();
            }
        }, { once: true });
    </script>
</body>
</html>
